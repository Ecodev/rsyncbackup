<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>13.&nbsp;Examples of usage</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.67.0"><link rel="start" href="index.html" title="rsyncbackup: User's Manual"><link rel="up" href="index.html" title="rsyncbackup: User's Manual"><link rel="prev" href="ar01s12.html" title="12.&nbsp;Notifications"><link rel="next" href="ar01s14.html" title="14.&nbsp;The rsync manpage"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">13.&nbsp;Examples of usage</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ar01s12.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ar01s14.html">Next</a></td></tr></table><hr></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e734"></a>13.&nbsp;Examples of usage</h2></div></div></div><p>In this chapter I will give a few examples of how you can use <span class="application">rsyncbackup</span>, beyound the most trivial backup scenarios described in the previous chapters.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e742"></a>13.1.&nbsp;Mirroring your iPhoto Library</h3></div></div></div><p>If you have several computers, and want to have your iPhoto library available and updated on all of them, then mirroring your iPhoto libarary could be a good idea. Remeber, the mirror is also a very good backup. Mirroring means that changes on the client will be discarded every time the mirroring is run.</p><p>We start with defining a source, which off course is the iPhoto library:</p><pre class="programlisting">photos|/Users/andreas/Pictures/iPhoto Library/|true|-a</pre><p>Then we need to define the destination:</p><pre class="programlisting">photos-mirror-epla|ssh[key=rsyncbackup]:andreas@epla.mydns.no:/Volumes/Media/iPhoto|traceroute -m 2 epla.mydns.no|</pre><p>In this example I put the iPhoto mirror on a firewire disk on the remote computer. By doing this, I can access the iPhoto mirror from more than one user on the remote computer, which I find preferable.</p><p>Then we need to add the following line in one or more backupsets to mirror our iPhoto library:</p><pre class="programlisting">photos|photos-mirror-epla|true|--progress</pre><p>Then, things are ready to be tested:</p><pre class="screen">rsyncbackup -b -s photo-sync -vv</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Synchronizing iPhoto Libarary</h3><p><span class="application">rsyncbackup</span> already have the capability to not only mirror, but synchronize iPhoto library between computers. I will test this myself, and document it when I know there is no issues related to it.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="syncing_folders"></a>13.2.&nbsp;Synchronizing folder between two computers</h3></div></div></div><p>We want to create a directory on our local computer, to be fully synchronized with folders on several remote computers. If you know Apple's iDisk, we will approach a similar solution, but hundres of times faster. First we create a local folder <code class="filename">~/InSync</code>. Then we configure the source:</p><pre class="programlisting">insync-local|local:/Users/andreas/inSync|true|-tlp</pre><p>Next up is creating a folder on the server to hold a copy of the folder, and configure the destination:</p><pre class="programlisting">insync-server|ssh[key=rsyncbackup]:andreas@myserver.mydomain.no:rsync_sync/inSync/|true|-tlp</pre><p>Since we are syncronizing, both the source and destination work as a source and as a destination, therefore we add the following section in both <code class="filename">sources.conf</code> and <code class="filename">destinations.conf</code>:</p><pre class="programlisting">
# Syncrhonizing the inSync folder
insync-local|local:/Users/andreas/inSync|true|-tlp
insync-server|ssh[key=rsyncbackup]:andreas@myserver.mydomain.no:rsync_sync/inSync/|true|-tlp</pre><p>We then add a new backupset for synchronization:</p><pre class="programlisting">
[sync]
insync-local|insync-server|true|-u
insync-server|insync-local|true|-u</pre><p>We run <span class="application">rsyncbackup</span> to copy the first version of the folder to the server:</p><pre class="screen">rsyncbackup -b -s sync -vv</pre><p>When this run smooth without errors, and you have fixed all your typos in your configuration files, we want to setup this in a crontab to synchronize in example every 10 minutes. Since synchronization is done very often, and rsync takes a bit CPU, we want to give synchronization process lower priority than other processes on your computer. This can be done with the <code class="literal">nice</code> command from the crontab file. The crontab entry could look like this:</p><pre class="programlisting">*/10 * * * * nice -n 19 rsyncbackup -b -s sync -e notifications@myserver.com</pre><p>The procude above should be followed for all computers wanting to participate in the synchronization.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Possibility of data loss</h3><p>When a file is changed on more than one computer in the interval since the last synchronization, the file with the most recent modification timestamp will the conflict, and the older file will be discarded. This means that such a synchronization folder has no intension to replace CVS or other revision control system.</p><p>You should do backuping (preferably incremental) of your synchronized folder if it contain important data.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="pithhelmetsync"></a>13.3.&nbsp;Synchronizing PithHelmet configuration</h3></div></div></div><p><a href="http://culater.net/software/PithHelmet/PithHelmet.php" target="_top">PithHelmet</a> is a very cool plugin to Safari, which can be configured to remove unwanted commercial on web sites. After using pithHelmet for a while, you will regularly tweak the configuration to better suit your needs. When having multiple computers, this means alot of work to do the same configuration on all versions. Therefore we will try to let rsyncbackup handle the syncing automaticly.</p><p>We locate the single configuration file used by PithHelmet and add a source:</p><pre class="programlisting">pithhelmetrules-local|local:/Users/andreas/Library/Application Support/PithHelmet/com.apple.Safari/PHRuleSet.ka|true|-t</pre><p>We create a <code class="filename">rsync_sync/pithhelmet</code> directory on the server, and add a destination:</p><pre class="programlisting">pithhelmetrules-server|ssh[key=rsyncbackup]:andreas@myserver.no:rsync_sync/pithhelmet/PHRuleSet.ka|true|-t</pre><p>The <code class="literal">-t</code> option means to preserve the timestamp on the server, which is crucial to get the synchronization to work.</p><p>We now add both the source and desination line to both <code class="filename">sources.conf</code> and <code class="filename">destinations.conf</code>, with the same argument as in <a href="ar01s13.html#syncing_folders" title="13.2.&nbsp;Synchronizing folder between two computers">Section&nbsp;13.2, &#8220;Synchronizing folder between two computers&#8221;</a>.</p><p>Next up is adding a backup set, but we have one problem we need to solve first. PithHelmet only reads configuration file when Safari starts. Therefore, if rsyncbackup updates the local configuration file while Safari is running, and you open the PithHelmet rule editor; then PithHelmet will use the configuration in memory, and save this to disk overwriting the "newer" version sync'ed from another computer. When overwriting the configuration file, the timestamp is updated, and this gived the old configutation a "new" timestamp, and this file will be synchornized back to the other computers, replacing the new version with the old one. To solve this problem we need to never run PithHelmet synchronization while Safari is running. We do that by using a conditional shell code (see <a href="ar01s10.html" title="10.&nbsp;Conditional shell code">Section&nbsp;10, &#8220;Conditional shell code&#8221;</a>) and the tool <code class="literal">isnotrunning</code> provided with rsyncbackup, in the <code class="filename">tools</code> folder. The backup set should look like this:</p><pre class="programlisting">
[sync]
# Synchronizing Pithhelmet...
pithhelmetrules-local|pithhelmetrules-server|true|-u
pithhelmetrules-server|pithhelmetrules-local|isnotrunning Safari.app|-u</pre><p>The procude above should be followed for all computers wanting to participate in the synchronization.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e870"></a>13.4.&nbsp;Synchronizing Safari bookmarks</h3></div></div></div><p>Coming soon...</p><p>Hint: <code class="filename">/Library/Safari/Bookmarks.plist</code>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e880"></a>13.5.&nbsp;Synchronizing Opera bookmarks</h3></div></div></div><p>Coming soon...</p><p>Hint: <code class="filename">Library/Preferences/Opera Preferences/Bookmarks</code>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e890"></a>13.6.&nbsp;Synchronizing FireFox bookmarks</h3></div></div></div><p>Coming soon...</p><p>Hint: <code class="filename">Library/Application Support/Firefox/Profiles/axeeepyy.default/bookmarks.html</code>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e900"></a>13.7.&nbsp;Backup to iPod connected to arbitrary computer</h3></div></div></div><p>Coming soon...</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ar01s12.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ar01s14.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">12.&nbsp;Notifications&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;14.&nbsp;The rsync manpage</td></tr></table></div></body></html>